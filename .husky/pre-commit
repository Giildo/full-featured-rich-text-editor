#!/bin/sh

echo "ğŸš‘ï¸ Running pre-commit checks..."

echo ""
echo "ğŸš¨ Running lint..."
if ! pnpm lint --max-warnings=0; then
  echo "ğŸ› Lint failed. Aborting commit."
  exit 1
fi
echo "âœ… Lint passed."
echo ""

echo ""
echo "ğŸ” Running format..."
pnpm format:silent
echo "âœ… Format passed."
echo ""

branch=$(git rev-parse --abbrev-ref HEAD)
if [ "$branch" = "develop" ] || [ "$branch" = "main" ]; then
  echo ""
  echo "ğŸ§ª Running unit test..."
  if ! pnpm test:unit --run; then
    echo "Unit test failed. Aborting commit."
    exit 1
  fi
  echo "âœ… Unit test passed."
  echo ""
fi

echo ""
echo "ğŸš‘ï¸ Pre-commit checks passed. Committing..."
exit 0